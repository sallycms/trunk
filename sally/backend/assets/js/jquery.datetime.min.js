(function(a){"use strict";var b=a("<a />"),c=function(a){return a<10?"0"+a:a},d=function(a,d,e){var f=a.getDate(),g=a.getDay(),h=a.getMonth(),i=a.getFullYear(),j=a.getUTCHours(),k=a.getUTCMinutes(),l=a.getUTCSeconds(),m={d:f,dd:c(f),ddd:e.shortDays[g],dddd:e.days[g],m:h+1,mm:c(h+1),mmm:e.shortMonths[h],mmmm:e.months[h],yy:(i+"").slice(2),yyyy:i,H:j,HH:c(j),M:k,MM:c(k),S:l,SS:c(l)},n=d.replace(/d{1,4}|m{1,4}|yy(?:yy)?|HH?|MM?|SS?|"[^"]*"|'[^']*'/g,function(a){return a in m?m[a]:a});return b.html(n).html()},e=function(a){var b=document.createElement("input");return b.setAttribute("type",a),b.type!=="text"},f={date:"yyyy-mm-dd","datetime-local":"yyyy-mm-ddTHH:MM"},g={date:e("date"),"datetime-local":e("datetime-local")},h=function(a,b){var c=i(a),d=g[c],e=a.prop("required"),f=a.nextAll(".sly-date-disabled"),h=a.nextAll(".sly-date-delete"),j=b==="",k=d&&j;a.toggle(!k),f.toggle(k),h.toggle(!e&&!j)},i=function(b){return a(b).data("sly-orig-type")},j=function(a){return a===""?new Date:new Date(Date.parse(a))},k=function(b){return a(b).nextAll(".sly-date-iso")},l=function(){return a(a("#calroot").data("sly-curelement"))},m=function(a,b){var c=k(a),e=i(a),g=a.data("sly-labels");c.val(b===""?"":d(b,f[e],g)),a.val(b===""?"":d(b,a.data("format"),g))},n=function(){var a="",b="abcdefghijklmnopqrstuvwxyz",c=0,d=15;for(;c<d;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a};a.fn.slyDateTime=function(b){var c=a.extend({},a.fn.slyDateTime.defaults,b),d=a(this).filter('input[type*="date"]'),e={months:c.lngMonths,shortMonths:c.lngShortMonths,days:c.lngDays,shortDays:c.lngShortDays};return a.tools.dateinput.localize("slydatetime",e),d.each(function(){var b=a(this),d=b.attr("type"),f=g[d],o=b.attr("type")==="datetime-local",p=b.data("format"),q=b.prop("required"),r=b.attr("name"),s=a('<a href="#" class="sly-date-delete"></a>').attr("title",c.lngDeleteDate),t=b.val()===""?"":j(b.val()),u=a('<input type="hidden" value="" class="sly-date-iso" />'),v=a('<span class="sly-date-disabled sly-form-read"><span>('+c.lngNoDateSelected+")</span></span>"),w=n();if(q&&f)return;f?(b.after(v).after(s),b.data("sly-orig-type",d)):(b.attr("name",c.nameFrmt.replace("%s",r)),u.attr("name",r),b.after(u),q||(v.attr("title",c.lngClickToInputDate),b.after(v).after(s)),b.addClass(w),b.dateinput({format:p,selectors:!1,lang:"slydatetime",offset:[5,0],firstDay:1}),b=a("."+w),b.removeClass(w),b.data("sly-labels",e),b.data("sly-orig-type",d),m(b,t)),h(b,t),v.click(function(){h(b,"dummy")}),s.click(function(){return h(b,""),m(b,""),!1});if(!f){b.on("change",function(){var a=b.data("dateinput").getValue();m(b,a),h(b,a)}),b.on("keydown",function(a){if(a.keyCode===8||a.keyCode===46)m(b,""),h(b,"")}),b.on("onBeforeShow",function(b){var c=i(b.target)!=="date";a(".sly-date-sliders").toggle(c),a("#calweeks").toggleClass("sly-has-time",c)});if(o){b.on("onBeforeShow",function(b){var c=b.target,d=a("#calroot"),e=a(".sly-date-range:first",d).data("rangeinput"),f=a(".sly-date-range:last",d).data("rangeinput"),g=k(c).val();d.data("sly-curelement",c),g===""?(e.setValue(0),f.setValue(0)):(g=j(g),e.setValue(g.getUTCHours()),f.setValue(g.getUTCMinutes()))}),b.on("beforeChange",function(a,c){var d=k(l()).val();return d!==""&&(d=j(d),c.setHours(d.getHours()),c.setMinutes(d.getMinutes()),c.setSeconds(d.getSeconds())),m(b,c),h(b,c),b.data("dateinput").hide().show(),!1});var x=a("#calbody");if(!x.is(".sly-has-time")){x.addClass("sly-has-time");var y=a('<div class="sly-date-sliders"></div>');y.append(a('<input type="range" min="0" max="23" step="1" data-type="hours" />').attr("name",r+"__slyhours")).append(a('<input type="range" min="0" max="59" step="1" data-type="minutes" />').attr("name",r+"__slyminutes")),x.append(y),a(":range",x).rangeinput({css:{slider:"sly-date-slider",input:"sly-date-range sly-form-text"}}),a(".sly-date-range:first",x).prop("readonly",!0).after("h"),a(".sly-date-range:last",x).prop("readonly",!0).after("m"),a(".sly-date-range",x).change(function(b,c){var d=a("#calroot"),e=l(),f=parseInt(a(".sly-date-range:first",d).val(),10),g=parseInt(a(".sly-date-range:last",d).val(),10),i=j(k(e).val());i.setUTCHours(f),i.setUTCMinutes(g),m(e,i),h(e,i)})}}}})},a.fn.slyDateTime.defaults={lngNoDateSelected:"kein Datum angegeben",lngDeleteDate:"löschen",lngClickToInputDate:"hier klicken, um ein Datum anzugeben",nameFrmt:"input_%s",lngMonths:"Januar,Februar,März,April,Mai,Juni,Juli,August,September,Oktober,November,Dezember",lngShortMonths:"Jan,Feb,Mär,Apr,Mai,Jun,Jul,Aug,Sep,Okt,Nov,Dez",lngDays:"Sonntag,Montag,Dienstag,Mittwoch,Donnerstag,Freitag,Samstag",lngShortDays:"So,Mo,Di,Mi,Do,Fr,Sa"}})(jQuery);